2025-11-05 15:08:38,451 - INFO - Strating benchmarking...
2025-11-05 15:12:25,620 - INFO - Strating benchmarking...
2025-11-05 15:13:59,196 - INFO - Strating benchmarking...
2025-11-05 15:13:59,196 - INFO - Random seed beállítva: 42
2025-11-05 15:14:26,959 - INFO - Strating benchmarking...
2025-11-05 15:14:26,960 - INFO - Random seed beállítva: 42
2025-11-05 15:16:01,307 - INFO - Strating benchmarking...
2025-11-05 15:16:01,308 - INFO - Random seed beállítva: 42
2025-11-05 15:19:09,935 - INFO - Strating benchmarking...
2025-11-05 15:19:09,935 - INFO - Random seed beállítva: 42
2025-11-05 15:19:09,936 - INFO - Load and preprocess data...
2025-11-05 15:19:09,937 - ERROR - Error during data loading: module 'preprocessing' has no attribute 'load_and_preprocess_data'
2025-11-07 11:47:41,937 - INFO - Strating benchmarking...
2025-11-07 11:47:41,937 - INFO - Random seed beállítva: 42
2025-11-07 11:47:41,938 - INFO - Load and preprocess data...
2025-11-07 11:47:41,938 - INFO - Adat-elõkészítési folyamat indítása...
2025-11-07 11:47:41,940 - ERROR - Kritikus hiba: A 'C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\raw\your_raw_data.csv' fájl nem található.
2025-11-07 11:47:41,940 - ERROR - Error during data loading: [Errno 2] No such file or directory: 'C:\\Users\\Gab\\BME\\szakdolgozat\\src\\xai_fraud_detection_benchmark\\data\\raw\\your_raw_data.csv'
2025-11-08 11:44:04,561 - INFO - Strating benchmarking...
2025-11-08 11:44:04,562 - INFO - Random seed beállítva: 42
2025-11-08 11:44:04,562 - INFO - Load and preprocess data...
2025-11-08 11:44:04,563 - INFO - Adat-elõkészítési folyamat indítása...
2025-11-08 11:44:04,563 - ERROR - Kritikus hiba: A 'C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\raw\your_raw_data.csv' fájl nem található.
2025-11-08 11:44:04,563 - ERROR - Error during data loading: [Errno 2] No such file or directory: 'C:\\Users\\Gab\\BME\\szakdolgozat\\src\\xai_fraud_detection_benchmark\\data\\raw\\your_raw_data.csv'
2025-11-08 11:44:18,379 - INFO - Strating benchmarking...
2025-11-08 11:44:18,380 - INFO - Random seed beállítva: 42
2025-11-08 11:44:18,380 - INFO - Load and preprocess data...
2025-11-08 11:44:18,381 - INFO - Adat-elõkészítési folyamat indítása...
2025-11-08 11:44:29,009 - INFO - Nyers adat sikeresen betöltve innen: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\raw\ieee_fraud.csv
2025-11-08 11:44:30,966 - INFO - Adatok szétválasztva. Train méret: (590535, 393), Test méret: (5, 393)
2025-11-08 11:44:31,378 - INFO - Azonosított numerikus oszlopok: ['TransactionID', 'TransactionDT', 'TransactionAmt', 'card1', 'card2', 'card3', 'card5', 'addr1', 'addr2', 'dist1', 'dist2', 'C1', 'C2', 'C3', 'C4', 'C5', 'C6', 'C7', 'C8', 'C9', 'C10', 'C11', 'C12', 'C13', 'C14', 'D1', 'D2', 'D3', 'D4', 'D5', 'D6', 'D7', 'D8', 'D9', 'D10', 'D11', 'D12', 'D13', 'D14', 'D15', 'V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9', 'V10', 'V11', 'V12', 'V13', 'V14', 'V15', 'V16', 'V17', 'V18', 'V19', 'V20', 'V21', 'V22', 'V23', 'V24', 'V25', 'V26', 'V27', 'V28', 'V29', 'V30', 'V31', 'V32', 'V33', 'V34', 'V35', 'V36', 'V37', 'V38', 'V39', 'V40', 'V41', 'V42', 'V43', 'V44', 'V45', 'V46', 'V47', 'V48', 'V49', 'V50', 'V51', 'V52', 'V53', 'V54', 'V55', 'V56', 'V57', 'V58', 'V59', 'V60', 'V61', 'V62', 'V63', 'V64', 'V65', 'V66', 'V67', 'V68', 'V69', 'V70', 'V71', 'V72', 'V73', 'V74', 'V75', 'V76', 'V77', 'V78', 'V79', 'V80', 'V81', 'V82', 'V83', 'V84', 'V85', 'V86', 'V87', 'V88', 'V89', 'V90', 'V91', 'V92', 'V93', 'V94', 'V95', 'V96', 'V97', 'V98', 'V99', 'V100', 'V101', 'V102', 'V103', 'V104', 'V105', 'V106', 'V107', 'V108', 'V109', 'V110', 'V111', 'V112', 'V113', 'V114', 'V115', 'V116', 'V117', 'V118', 'V119', 'V120', 'V121', 'V122', 'V123', 'V124', 'V125', 'V126', 'V127', 'V128', 'V129', 'V130', 'V131', 'V132', 'V133', 'V134', 'V135', 'V136', 'V137', 'V138', 'V139', 'V140', 'V141', 'V142', 'V143', 'V144', 'V145', 'V146', 'V147', 'V148', 'V149', 'V150', 'V151', 'V152', 'V153', 'V154', 'V155', 'V156', 'V157', 'V158', 'V159', 'V160', 'V161', 'V162', 'V163', 'V164', 'V165', 'V166', 'V167', 'V168', 'V169', 'V170', 'V171', 'V172', 'V173', 'V174', 'V175', 'V176', 'V177', 'V178', 'V179', 'V180', 'V181', 'V182', 'V183', 'V184', 'V185', 'V186', 'V187', 'V188', 'V189', 'V190', 'V191', 'V192', 'V193', 'V194', 'V195', 'V196', 'V197', 'V198', 'V199', 'V200', 'V201', 'V202', 'V203', 'V204', 'V205', 'V206', 'V207', 'V208', 'V209', 'V210', 'V211', 'V212', 'V213', 'V214', 'V215', 'V216', 'V217', 'V218', 'V219', 'V220', 'V221', 'V222', 'V223', 'V224', 'V225', 'V226', 'V227', 'V228', 'V229', 'V230', 'V231', 'V232', 'V233', 'V234', 'V235', 'V236', 'V237', 'V238', 'V239', 'V240', 'V241', 'V242', 'V243', 'V244', 'V245', 'V246', 'V247', 'V248', 'V249', 'V250', 'V251', 'V252', 'V253', 'V254', 'V255', 'V256', 'V257', 'V258', 'V259', 'V260', 'V261', 'V262', 'V263', 'V264', 'V265', 'V266', 'V267', 'V268', 'V269', 'V270', 'V271', 'V272', 'V273', 'V274', 'V275', 'V276', 'V277', 'V278', 'V279', 'V280', 'V281', 'V282', 'V283', 'V284', 'V285', 'V286', 'V287', 'V288', 'V289', 'V290', 'V291', 'V292', 'V293', 'V294', 'V295', 'V296', 'V297', 'V298', 'V299', 'V300', 'V301', 'V302', 'V303', 'V304', 'V305', 'V306', 'V307', 'V308', 'V309', 'V310', 'V311', 'V312', 'V313', 'V314', 'V315', 'V316', 'V317', 'V318', 'V319', 'V320', 'V321', 'V322', 'V323', 'V324', 'V325', 'V326', 'V327', 'V328', 'V329', 'V330', 'V331', 'V332', 'V333', 'V334', 'V335', 'V336', 'V337', 'V338', 'V339']
2025-11-08 11:44:31,379 - INFO - Azonosított kategorikus oszlopok: ['ProductCD', 'card4', 'card6', 'P_emaildomain', 'R_emaildomain', 'M1', 'M2', 'M3', 'M4', 'M5', 'M6', 'M7', 'M8', 'M9']
2025-11-08 11:44:31,379 - INFO - Preprocessing pipeline illesztése (fit) a train adatokra...
2025-11-08 11:45:00,268 - INFO - Preprocessing pipeline alkalmazása (transform) a test adatokra...
2025-11-08 11:45:00,278 - INFO - Feldolgozó pipeline (preprocessor) elmentve ide: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\processed\preprocessor.pkl
2025-11-08 11:49:59,300 - INFO - Feldolgozott train/test szettek elmentve a(z) 'C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\processed' mappába.
2025-11-08 11:49:59,627 - INFO - Successfuly loaded data. Train size: (590535, 530), Test size: (5, 530)
2025-11-08 11:49:59,629 - INFO - Starting iteration with following models: ['logistic_regression', 'random_forest', 'gradient_boosting']
2025-11-08 11:49:59,629 - INFO - --- Model: logistic_regression ---
2025-11-08 11:49:59,629 - INFO - Initialize model parameters from config...
2025-11-08 11:49:59,629 - INFO - Training and evaluating...
2025-11-08 11:49:59,629 - INFO - Starting model training: LogisticRegression...
2025-11-08 12:09:39,090 - INFO - LogisticRegression training finished.
2025-11-08 12:09:39,090 - INFO - Prediction on test dataset
2025-11-08 12:09:39,104 - INFO - Metrikák számítása...
2025-11-08 12:09:39,105 - WARNING - Unkonwn metric: 'f1_score'
2025-11-08 12:09:39,110 - INFO - Results (logistic_regression): {'accuracy': 1.0, 'roc_auc': nan}
2025-11-08 12:09:39,111 - INFO - Model saved to: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\results\models\logistic_regression.pkl
2025-11-08 12:09:39,113 - ERROR - Error with model: logistic_regression: module 'config' has no attribute 'RUN_SHAP'
2025-11-08 12:09:39,113 - INFO - --- Model: random_forest ---
2025-11-08 12:09:39,113 - INFO - Initialize model parameters from config...
2025-11-08 12:09:39,113 - INFO - Training and evaluating...
2025-11-08 12:09:39,114 - INFO - Starting model training: RandomForestClassifier...
2025-11-08 12:13:23,999 - INFO - RandomForestClassifier training finished.
2025-11-08 12:13:23,999 - INFO - Prediction on test dataset
2025-11-08 12:13:24,017 - INFO - Metrikák számítása...
2025-11-08 12:13:24,018 - WARNING - Unkonwn metric: 'f1_score'
2025-11-08 12:13:24,023 - INFO - Results (random_forest): {'accuracy': 1.0, 'roc_auc': nan}
2025-11-08 12:13:24,035 - INFO - Model saved to: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\results\models\random_forest.pkl
2025-11-08 12:13:24,035 - ERROR - Error with model: random_forest: module 'config' has no attribute 'RUN_SHAP'
2025-11-08 12:13:24,035 - INFO - --- Model: gradient_boosting ---
2025-11-08 12:13:24,036 - INFO - Initialize model parameters from config...
2025-11-08 12:13:24,036 - INFO - Training and evaluating...
2025-11-08 12:13:24,036 - INFO - Starting model training: GradientBoostingClassifier...
2025-11-08 14:47:13,210 - INFO - Strating benchmarking...
2025-11-08 14:47:13,211 - INFO - Random seed beállítva: 42
2025-11-08 14:47:13,211 - INFO - Load and preprocess data...
2025-11-08 14:47:13,211 - INFO - Adat-elõkészítési folyamat indítása...
2025-11-08 14:47:24,289 - INFO - Nyers adat sikeresen betöltve innen: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\raw\ieee_fraud.csv
2025-11-08 14:47:26,373 - INFO - Adatok szétválasztva. Train méret: (472432, 393), Test méret: (118108, 393)
2025-11-08 14:47:26,802 - INFO - Azonosított numerikus oszlopok: ['TransactionID', 'TransactionDT', 'TransactionAmt', 'card1', 'card2', 'card3', 'card5', 'addr1', 'addr2', 'dist1', 'dist2', 'C1', 'C2', 'C3', 'C4', 'C5', 'C6', 'C7', 'C8', 'C9', 'C10', 'C11', 'C12', 'C13', 'C14', 'D1', 'D2', 'D3', 'D4', 'D5', 'D6', 'D7', 'D8', 'D9', 'D10', 'D11', 'D12', 'D13', 'D14', 'D15', 'V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9', 'V10', 'V11', 'V12', 'V13', 'V14', 'V15', 'V16', 'V17', 'V18', 'V19', 'V20', 'V21', 'V22', 'V23', 'V24', 'V25', 'V26', 'V27', 'V28', 'V29', 'V30', 'V31', 'V32', 'V33', 'V34', 'V35', 'V36', 'V37', 'V38', 'V39', 'V40', 'V41', 'V42', 'V43', 'V44', 'V45', 'V46', 'V47', 'V48', 'V49', 'V50', 'V51', 'V52', 'V53', 'V54', 'V55', 'V56', 'V57', 'V58', 'V59', 'V60', 'V61', 'V62', 'V63', 'V64', 'V65', 'V66', 'V67', 'V68', 'V69', 'V70', 'V71', 'V72', 'V73', 'V74', 'V75', 'V76', 'V77', 'V78', 'V79', 'V80', 'V81', 'V82', 'V83', 'V84', 'V85', 'V86', 'V87', 'V88', 'V89', 'V90', 'V91', 'V92', 'V93', 'V94', 'V95', 'V96', 'V97', 'V98', 'V99', 'V100', 'V101', 'V102', 'V103', 'V104', 'V105', 'V106', 'V107', 'V108', 'V109', 'V110', 'V111', 'V112', 'V113', 'V114', 'V115', 'V116', 'V117', 'V118', 'V119', 'V120', 'V121', 'V122', 'V123', 'V124', 'V125', 'V126', 'V127', 'V128', 'V129', 'V130', 'V131', 'V132', 'V133', 'V134', 'V135', 'V136', 'V137', 'V138', 'V139', 'V140', 'V141', 'V142', 'V143', 'V144', 'V145', 'V146', 'V147', 'V148', 'V149', 'V150', 'V151', 'V152', 'V153', 'V154', 'V155', 'V156', 'V157', 'V158', 'V159', 'V160', 'V161', 'V162', 'V163', 'V164', 'V165', 'V166', 'V167', 'V168', 'V169', 'V170', 'V171', 'V172', 'V173', 'V174', 'V175', 'V176', 'V177', 'V178', 'V179', 'V180', 'V181', 'V182', 'V183', 'V184', 'V185', 'V186', 'V187', 'V188', 'V189', 'V190', 'V191', 'V192', 'V193', 'V194', 'V195', 'V196', 'V197', 'V198', 'V199', 'V200', 'V201', 'V202', 'V203', 'V204', 'V205', 'V206', 'V207', 'V208', 'V209', 'V210', 'V211', 'V212', 'V213', 'V214', 'V215', 'V216', 'V217', 'V218', 'V219', 'V220', 'V221', 'V222', 'V223', 'V224', 'V225', 'V226', 'V227', 'V228', 'V229', 'V230', 'V231', 'V232', 'V233', 'V234', 'V235', 'V236', 'V237', 'V238', 'V239', 'V240', 'V241', 'V242', 'V243', 'V244', 'V245', 'V246', 'V247', 'V248', 'V249', 'V250', 'V251', 'V252', 'V253', 'V254', 'V255', 'V256', 'V257', 'V258', 'V259', 'V260', 'V261', 'V262', 'V263', 'V264', 'V265', 'V266', 'V267', 'V268', 'V269', 'V270', 'V271', 'V272', 'V273', 'V274', 'V275', 'V276', 'V277', 'V278', 'V279', 'V280', 'V281', 'V282', 'V283', 'V284', 'V285', 'V286', 'V287', 'V288', 'V289', 'V290', 'V291', 'V292', 'V293', 'V294', 'V295', 'V296', 'V297', 'V298', 'V299', 'V300', 'V301', 'V302', 'V303', 'V304', 'V305', 'V306', 'V307', 'V308', 'V309', 'V310', 'V311', 'V312', 'V313', 'V314', 'V315', 'V316', 'V317', 'V318', 'V319', 'V320', 'V321', 'V322', 'V323', 'V324', 'V325', 'V326', 'V327', 'V328', 'V329', 'V330', 'V331', 'V332', 'V333', 'V334', 'V335', 'V336', 'V337', 'V338', 'V339']
2025-11-08 14:47:26,803 - INFO - Azonosított kategorikus oszlopok: ['ProductCD', 'card4', 'card6', 'P_emaildomain', 'R_emaildomain', 'M1', 'M2', 'M3', 'M4', 'M5', 'M6', 'M7', 'M8', 'M9']
2025-11-08 14:47:26,803 - INFO - Preprocessing pipeline illesztése (fit) a train adatokra...
2025-11-08 14:47:48,508 - INFO - Preprocessing pipeline alkalmazása (transform) a test adatokra...
2025-11-08 14:47:49,837 - INFO - Feldolgozó pipeline (preprocessor) elmentve ide: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\processed\preprocessor.pkl
2025-11-08 14:52:38,643 - INFO - Feldolgozott train/test szettek elmentve a(z) 'C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\processed' mappába.
2025-11-08 14:52:39,112 - INFO - Successfuly loaded data. Train size: (472432, 530), Test size: (118108, 530)
2025-11-08 14:52:39,112 - INFO - Starting iteration with following models: ['logistic_regression', 'random_forest', 'gradient_boosting']
2025-11-08 14:52:39,113 - INFO - --- Model: logistic_regression ---
2025-11-08 14:52:39,113 - INFO - Initialize model parameters from config...
2025-11-08 14:52:39,113 - INFO - Training and evaluating...
2025-11-08 14:52:39,114 - INFO - Starting model training: LogisticRegression...
2025-11-08 15:01:32,154 - INFO - LogisticRegression training finished.
2025-11-08 15:01:32,155 - INFO - Prediction on test dataset
2025-11-08 15:01:32,296 - INFO - Metrikák számítása...
2025-11-08 15:01:32,325 - WARNING - Can not calculate PR-AUC pred_proba is missing
2025-11-08 15:01:32,326 - INFO - Results (logistic_regression): {'accuracy': 0.9720086700308193, 'f1_score': 0.9648632181206812, 'pr_auc': None}
2025-11-08 15:01:32,327 - INFO - Model saved to: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\results\models\logistic_regression.pkl
2025-11-08 15:01:32,328 - INFO - SHAP magyarázat generálása (logistic_regression)...
2025-11-08 15:01:32,328 - INFO - Starting SHAP explanation on model: logistic_regression...
2025-11-08 15:01:32,333 - ERROR - Hiba a SHAP magyarázat generálása során (logistic_regression): max_evals=500 is too low for the Permutation explainer, it must be at least 2 * num_features + 1 = 779!
Traceback (most recent call last):
  File "c:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\src\explain.py", line 51, in generate_shap_values
    shap_values_obj = explainer(X_data)
                      ^^^^^^^^^^^^^^^^^
  File "C:\Users\Gab\anaconda3\envs\szakdolgozat_env\Lib\site-packages\shap\explainers\_permutation.py", line 100, in __call__
    return super().__call__(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Gab\anaconda3\envs\szakdolgozat_env\Lib\site-packages\shap\explainers\_explainer.py", line 366, in __call__
    row_result = self.explain_row(
                 ^^^^^^^^^^^^^^^^^
  File "C:\Users\Gab\anaconda3\envs\szakdolgozat_env\Lib\site-packages\shap\explainers\_permutation.py", line 192, in explain_row
    raise ValueError(
ValueError: max_evals=500 is too low for the Permutation explainer, it must be at least 2 * num_features + 1 = 779!
2025-11-08 15:01:32,338 - INFO - SHAP magyarázat elmentve.
2025-11-08 15:01:32,338 - INFO - --- Model: random_forest ---
2025-11-08 15:01:32,338 - INFO - Initialize model parameters from config...
2025-11-08 15:01:32,338 - INFO - Training and evaluating...
2025-11-08 15:01:32,339 - INFO - Starting model training: RandomForestClassifier...
2025-11-08 15:18:10,281 - INFO - Strating benchmarking...
2025-11-08 15:18:10,281 - INFO - Random seed beállítva: 42
2025-11-08 15:18:10,282 - INFO - Load and preprocess data...
2025-11-08 15:18:10,282 - INFO - Adat-elõkészítési folyamat indítása...
2025-11-08 15:18:20,524 - INFO - Nyers adat sikeresen betöltve innen: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\raw\ieee_fraud.csv
2025-11-08 15:18:22,260 - INFO - Adatok szétválasztva. Train méret: (472432, 393), Test méret: (118108, 393)
2025-11-08 15:18:22,542 - INFO - Azonosított numerikus oszlopok: ['TransactionID', 'TransactionDT', 'TransactionAmt', 'card1', 'card2', 'card3', 'card5', 'addr1', 'addr2', 'dist1', 'dist2', 'C1', 'C2', 'C3', 'C4', 'C5', 'C6', 'C7', 'C8', 'C9', 'C10', 'C11', 'C12', 'C13', 'C14', 'D1', 'D2', 'D3', 'D4', 'D5', 'D6', 'D7', 'D8', 'D9', 'D10', 'D11', 'D12', 'D13', 'D14', 'D15', 'V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9', 'V10', 'V11', 'V12', 'V13', 'V14', 'V15', 'V16', 'V17', 'V18', 'V19', 'V20', 'V21', 'V22', 'V23', 'V24', 'V25', 'V26', 'V27', 'V28', 'V29', 'V30', 'V31', 'V32', 'V33', 'V34', 'V35', 'V36', 'V37', 'V38', 'V39', 'V40', 'V41', 'V42', 'V43', 'V44', 'V45', 'V46', 'V47', 'V48', 'V49', 'V50', 'V51', 'V52', 'V53', 'V54', 'V55', 'V56', 'V57', 'V58', 'V59', 'V60', 'V61', 'V62', 'V63', 'V64', 'V65', 'V66', 'V67', 'V68', 'V69', 'V70', 'V71', 'V72', 'V73', 'V74', 'V75', 'V76', 'V77', 'V78', 'V79', 'V80', 'V81', 'V82', 'V83', 'V84', 'V85', 'V86', 'V87', 'V88', 'V89', 'V90', 'V91', 'V92', 'V93', 'V94', 'V95', 'V96', 'V97', 'V98', 'V99', 'V100', 'V101', 'V102', 'V103', 'V104', 'V105', 'V106', 'V107', 'V108', 'V109', 'V110', 'V111', 'V112', 'V113', 'V114', 'V115', 'V116', 'V117', 'V118', 'V119', 'V120', 'V121', 'V122', 'V123', 'V124', 'V125', 'V126', 'V127', 'V128', 'V129', 'V130', 'V131', 'V132', 'V133', 'V134', 'V135', 'V136', 'V137', 'V138', 'V139', 'V140', 'V141', 'V142', 'V143', 'V144', 'V145', 'V146', 'V147', 'V148', 'V149', 'V150', 'V151', 'V152', 'V153', 'V154', 'V155', 'V156', 'V157', 'V158', 'V159', 'V160', 'V161', 'V162', 'V163', 'V164', 'V165', 'V166', 'V167', 'V168', 'V169', 'V170', 'V171', 'V172', 'V173', 'V174', 'V175', 'V176', 'V177', 'V178', 'V179', 'V180', 'V181', 'V182', 'V183', 'V184', 'V185', 'V186', 'V187', 'V188', 'V189', 'V190', 'V191', 'V192', 'V193', 'V194', 'V195', 'V196', 'V197', 'V198', 'V199', 'V200', 'V201', 'V202', 'V203', 'V204', 'V205', 'V206', 'V207', 'V208', 'V209', 'V210', 'V211', 'V212', 'V213', 'V214', 'V215', 'V216', 'V217', 'V218', 'V219', 'V220', 'V221', 'V222', 'V223', 'V224', 'V225', 'V226', 'V227', 'V228', 'V229', 'V230', 'V231', 'V232', 'V233', 'V234', 'V235', 'V236', 'V237', 'V238', 'V239', 'V240', 'V241', 'V242', 'V243', 'V244', 'V245', 'V246', 'V247', 'V248', 'V249', 'V250', 'V251', 'V252', 'V253', 'V254', 'V255', 'V256', 'V257', 'V258', 'V259', 'V260', 'V261', 'V262', 'V263', 'V264', 'V265', 'V266', 'V267', 'V268', 'V269', 'V270', 'V271', 'V272', 'V273', 'V274', 'V275', 'V276', 'V277', 'V278', 'V279', 'V280', 'V281', 'V282', 'V283', 'V284', 'V285', 'V286', 'V287', 'V288', 'V289', 'V290', 'V291', 'V292', 'V293', 'V294', 'V295', 'V296', 'V297', 'V298', 'V299', 'V300', 'V301', 'V302', 'V303', 'V304', 'V305', 'V306', 'V307', 'V308', 'V309', 'V310', 'V311', 'V312', 'V313', 'V314', 'V315', 'V316', 'V317', 'V318', 'V319', 'V320', 'V321', 'V322', 'V323', 'V324', 'V325', 'V326', 'V327', 'V328', 'V329', 'V330', 'V331', 'V332', 'V333', 'V334', 'V335', 'V336', 'V337', 'V338', 'V339']
2025-11-08 15:18:22,542 - INFO - Azonosított kategorikus oszlopok: ['ProductCD', 'card4', 'card6', 'P_emaildomain', 'R_emaildomain', 'M1', 'M2', 'M3', 'M4', 'M5', 'M6', 'M7', 'M8', 'M9']
2025-11-08 15:18:22,543 - INFO - Preprocessing pipeline illesztése (fit) a train adatokra...
2025-11-08 15:18:44,447 - INFO - Preprocessing pipeline alkalmazása (transform) a test adatokra...
2025-11-08 15:18:45,782 - INFO - Feldolgozó pipeline (preprocessor) elmentve ide: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\processed\preprocessor.pkl
2025-11-08 15:23:32,577 - INFO - Feldolgozott train/test szettek elmentve a(z) 'C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\processed' mappába.
2025-11-08 15:23:32,879 - INFO - Successfuly loaded data. Train size: (472432, 530), Test size: (118108, 530)
2025-11-08 15:23:32,879 - INFO - Starting iteration with following models: ['logistic_regression', 'random_forest', 'gradient_boosting']
2025-11-08 15:23:32,879 - INFO - --- Model: logistic_regression ---
2025-11-08 15:23:32,879 - INFO - Initialize model parameters from config...
2025-11-08 15:23:32,880 - INFO - Training and evaluating...
2025-11-08 15:23:32,880 - INFO - Starting model training: LogisticRegression...
2025-11-08 15:32:23,542 - INFO - LogisticRegression training finished.
2025-11-08 15:32:23,542 - INFO - Prediction on test dataset
2025-11-08 15:32:23,679 - INFO - Metrikák számítása...
2025-11-08 15:32:23,702 - WARNING - Can not calculate PR-AUC pred_proba is missing
2025-11-08 15:32:23,702 - INFO - Results (logistic_regression): {'accuracy': 0.9720086700308193, 'f1_score': 0.9648632181206812, 'pr_auc': None}
2025-11-08 15:32:23,703 - INFO - Model saved to: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\results\models\logistic_regression.pkl
2025-11-08 15:32:23,703 - INFO - SHAP magyarázat generálása (logistic_regression)...
2025-11-08 15:32:23,703 - ERROR - Error with model: logistic_regression: generate_shap_values() got an unexpected keyword argument 'X_data_to_explain'
2025-11-08 15:32:23,703 - INFO - --- Model: random_forest ---
2025-11-08 15:32:23,703 - INFO - Initialize model parameters from config...
2025-11-08 15:32:23,703 - INFO - Training and evaluating...
2025-11-08 15:32:23,705 - INFO - Starting model training: RandomForestClassifier...
2025-11-08 15:33:34,252 - INFO - Strating benchmarking...
2025-11-08 15:33:34,253 - INFO - Random seed beállítva: 42
2025-11-08 15:33:34,254 - INFO - Load and preprocess data...
2025-11-08 15:33:34,254 - INFO - Adat-elõkészítési folyamat indítása...
2025-11-08 15:33:46,324 - INFO - Nyers adat sikeresen betöltve innen: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\raw\ieee_fraud.csv
2025-11-08 15:33:48,287 - INFO - Adatok szétválasztva. Train méret: (472432, 393), Test méret: (118108, 393)
2025-11-08 15:33:48,641 - INFO - Azonosított numerikus oszlopok: ['TransactionID', 'TransactionDT', 'TransactionAmt', 'card1', 'card2', 'card3', 'card5', 'addr1', 'addr2', 'dist1', 'dist2', 'C1', 'C2', 'C3', 'C4', 'C5', 'C6', 'C7', 'C8', 'C9', 'C10', 'C11', 'C12', 'C13', 'C14', 'D1', 'D2', 'D3', 'D4', 'D5', 'D6', 'D7', 'D8', 'D9', 'D10', 'D11', 'D12', 'D13', 'D14', 'D15', 'V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9', 'V10', 'V11', 'V12', 'V13', 'V14', 'V15', 'V16', 'V17', 'V18', 'V19', 'V20', 'V21', 'V22', 'V23', 'V24', 'V25', 'V26', 'V27', 'V28', 'V29', 'V30', 'V31', 'V32', 'V33', 'V34', 'V35', 'V36', 'V37', 'V38', 'V39', 'V40', 'V41', 'V42', 'V43', 'V44', 'V45', 'V46', 'V47', 'V48', 'V49', 'V50', 'V51', 'V52', 'V53', 'V54', 'V55', 'V56', 'V57', 'V58', 'V59', 'V60', 'V61', 'V62', 'V63', 'V64', 'V65', 'V66', 'V67', 'V68', 'V69', 'V70', 'V71', 'V72', 'V73', 'V74', 'V75', 'V76', 'V77', 'V78', 'V79', 'V80', 'V81', 'V82', 'V83', 'V84', 'V85', 'V86', 'V87', 'V88', 'V89', 'V90', 'V91', 'V92', 'V93', 'V94', 'V95', 'V96', 'V97', 'V98', 'V99', 'V100', 'V101', 'V102', 'V103', 'V104', 'V105', 'V106', 'V107', 'V108', 'V109', 'V110', 'V111', 'V112', 'V113', 'V114', 'V115', 'V116', 'V117', 'V118', 'V119', 'V120', 'V121', 'V122', 'V123', 'V124', 'V125', 'V126', 'V127', 'V128', 'V129', 'V130', 'V131', 'V132', 'V133', 'V134', 'V135', 'V136', 'V137', 'V138', 'V139', 'V140', 'V141', 'V142', 'V143', 'V144', 'V145', 'V146', 'V147', 'V148', 'V149', 'V150', 'V151', 'V152', 'V153', 'V154', 'V155', 'V156', 'V157', 'V158', 'V159', 'V160', 'V161', 'V162', 'V163', 'V164', 'V165', 'V166', 'V167', 'V168', 'V169', 'V170', 'V171', 'V172', 'V173', 'V174', 'V175', 'V176', 'V177', 'V178', 'V179', 'V180', 'V181', 'V182', 'V183', 'V184', 'V185', 'V186', 'V187', 'V188', 'V189', 'V190', 'V191', 'V192', 'V193', 'V194', 'V195', 'V196', 'V197', 'V198', 'V199', 'V200', 'V201', 'V202', 'V203', 'V204', 'V205', 'V206', 'V207', 'V208', 'V209', 'V210', 'V211', 'V212', 'V213', 'V214', 'V215', 'V216', 'V217', 'V218', 'V219', 'V220', 'V221', 'V222', 'V223', 'V224', 'V225', 'V226', 'V227', 'V228', 'V229', 'V230', 'V231', 'V232', 'V233', 'V234', 'V235', 'V236', 'V237', 'V238', 'V239', 'V240', 'V241', 'V242', 'V243', 'V244', 'V245', 'V246', 'V247', 'V248', 'V249', 'V250', 'V251', 'V252', 'V253', 'V254', 'V255', 'V256', 'V257', 'V258', 'V259', 'V260', 'V261', 'V262', 'V263', 'V264', 'V265', 'V266', 'V267', 'V268', 'V269', 'V270', 'V271', 'V272', 'V273', 'V274', 'V275', 'V276', 'V277', 'V278', 'V279', 'V280', 'V281', 'V282', 'V283', 'V284', 'V285', 'V286', 'V287', 'V288', 'V289', 'V290', 'V291', 'V292', 'V293', 'V294', 'V295', 'V296', 'V297', 'V298', 'V299', 'V300', 'V301', 'V302', 'V303', 'V304', 'V305', 'V306', 'V307', 'V308', 'V309', 'V310', 'V311', 'V312', 'V313', 'V314', 'V315', 'V316', 'V317', 'V318', 'V319', 'V320', 'V321', 'V322', 'V323', 'V324', 'V325', 'V326', 'V327', 'V328', 'V329', 'V330', 'V331', 'V332', 'V333', 'V334', 'V335', 'V336', 'V337', 'V338', 'V339']
2025-11-08 15:33:48,642 - INFO - Azonosított kategorikus oszlopok: ['ProductCD', 'card4', 'card6', 'P_emaildomain', 'R_emaildomain', 'M1', 'M2', 'M3', 'M4', 'M5', 'M6', 'M7', 'M8', 'M9']
2025-11-08 15:33:48,642 - INFO - Preprocessing pipeline illesztése (fit) a train adatokra...
2025-11-08 15:34:13,073 - INFO - Preprocessing pipeline alkalmazása (transform) a test adatokra...
2025-11-08 15:34:14,791 - INFO - Feldolgozó pipeline (preprocessor) elmentve ide: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\processed\preprocessor.pkl
2025-11-08 15:39:29,220 - INFO - Feldolgozott train/test szettek elmentve a(z) 'C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\data\processed' mappába.
2025-11-08 15:39:29,497 - INFO - Successfuly loaded data. Train size: (472432, 530), Test size: (118108, 530)
2025-11-08 15:39:29,498 - INFO - Starting iteration with following models: ['logistic_regression', 'random_forest', 'gradient_boosting']
2025-11-08 15:39:29,498 - INFO - --- Model: logistic_regression ---
2025-11-08 15:39:29,498 - INFO - Initialize model parameters from config...
2025-11-08 15:39:29,498 - INFO - Training and evaluating...
2025-11-08 15:39:29,499 - INFO - Starting model training: LogisticRegression...
2025-11-08 15:48:08,478 - INFO - LogisticRegression training finished.
2025-11-08 15:48:08,478 - INFO - Prediction on test dataset
2025-11-08 15:48:08,616 - INFO - Metrikák számítása...
2025-11-08 15:48:08,643 - WARNING - Can not calculate PR-AUC pred_proba is missing
2025-11-08 15:48:08,643 - INFO - Results (logistic_regression): {'accuracy': 0.9720086700308193, 'f1_score': 0.9648632181206812, 'pr_auc': None}
2025-11-08 15:48:08,644 - INFO - Model saved to: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\results\models\logistic_regression.pkl
2025-11-08 15:48:08,644 - INFO - SHAP magyarázat generálása (logistic_regression)...
2025-11-08 15:48:08,644 - INFO - Starting SHAP explanation on model: logistic_regression...
2025-11-08 15:48:08,660 - INFO - Calculating SHAP values...
2025-11-08 15:48:12,847 - INFO - SHAP calculation finished.
2025-11-08 15:48:12,883 - INFO - SHAP magyarázat elmentve.
2025-11-08 15:48:12,883 - INFO - --- Model: random_forest ---
2025-11-08 15:48:12,884 - INFO - Initialize model parameters from config...
2025-11-08 15:48:12,884 - INFO - Training and evaluating...
2025-11-08 15:48:12,884 - INFO - Starting model training: RandomForestClassifier...
2025-11-08 15:51:04,714 - INFO - RandomForestClassifier training finished.
2025-11-08 15:51:04,715 - INFO - Prediction on test dataset
2025-11-08 15:51:06,126 - INFO - Metrikák számítása...
2025-11-08 15:51:06,148 - WARNING - Can not calculate PR-AUC pred_proba is missing
2025-11-08 15:51:06,149 - INFO - Results (random_forest): {'accuracy': 0.9733887628272428, 'f1_score': 0.9660632551414539, 'pr_auc': None}
2025-11-08 15:51:06,168 - INFO - Model saved to: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\results\models\random_forest.pkl
2025-11-08 15:51:06,168 - INFO - SHAP magyarázat generálása (random_forest)...
2025-11-08 15:51:06,168 - INFO - Starting SHAP explanation on model: random_forest...
2025-11-08 15:51:06,199 - INFO - Calculating SHAP values...
2025-11-08 16:06:39,583 - ERROR - Hiba a SHAP magyarázat generálása során (random_forest): Additivity check failed in TreeExplainer! Please ensure the data matrix you passed to the explainer is the same shape that the model was trained on. If your data shape is correct then please report this on GitHub. This check failed because for one of the samples the sum of the SHAP values was 0.721581, while the model output was 0.703335. If this difference is acceptable you can set check_additivity=False to disable this check.
Traceback (most recent call last):
  File "c:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\src\explain.py", line 67, in generate_shap_values
    shap_values_obj = explainer(X_to_explain)
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gab\anaconda3\envs\szakdolgozat_env\Lib\site-packages\shap\explainers\_tree.py", line 380, in __call__
    v = self.shap_values(X, y=y, from_call=True, check_additivity=check_additivity, approximate=approximate)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gab\anaconda3\envs\szakdolgozat_env\Lib\site-packages\shap\explainers\_tree.py", line 672, in shap_values
    self.assert_additivity(out, self.model.predict(X))
  File "C:\Users\Gab\anaconda3\envs\szakdolgozat_env\Lib\site-packages\shap\explainers\_tree.py", line 856, in assert_additivity
    check_sum(self.expected_value[i] + phi[i].sum(-1), model_output[:, i])
  File "C:\Users\Gab\anaconda3\envs\szakdolgozat_env\Lib\site-packages\shap\explainers\_tree.py", line 852, in check_sum
    raise ExplainerError(err_msg)
shap.utils._exceptions.ExplainerError: Additivity check failed in TreeExplainer! Please ensure the data matrix you passed to the explainer is the same shape that the model was trained on. If your data shape is correct then please report this on GitHub. This check failed because for one of the samples the sum of the SHAP values was 0.721581, while the model output was 0.703335. If this difference is acceptable you can set check_additivity=False to disable this check.
2025-11-08 16:06:39,652 - INFO - SHAP magyarázat elmentve.
2025-11-08 16:06:39,652 - INFO - --- Model: gradient_boosting ---
2025-11-08 16:06:39,653 - INFO - Initialize model parameters from config...
2025-11-08 16:06:39,653 - INFO - Training and evaluating...
2025-11-08 16:06:39,653 - INFO - Starting model training: GradientBoostingClassifier...
2025-11-08 16:54:29,480 - INFO - GradientBoostingClassifier training finished.
2025-11-08 16:54:29,480 - INFO - Prediction on test dataset
2025-11-08 16:54:30,356 - INFO - Metrikák számítása...
2025-11-08 16:54:30,374 - WARNING - Can not calculate PR-AUC pred_proba is missing
2025-11-08 16:54:30,378 - INFO - Results (gradient_boosting): {'accuracy': 0.9745063839875369, 'f1_score': 0.9688491915681886, 'pr_auc': None}
2025-11-08 16:54:30,386 - INFO - Model saved to: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\results\models\gradient_boosting.pkl
2025-11-08 16:54:30,386 - INFO - SHAP magyarázat generálása (gradient_boosting)...
2025-11-08 16:54:30,387 - INFO - Starting SHAP explanation on model: gradient_boosting...
2025-11-08 16:54:30,403 - INFO - Calculating SHAP values...
2025-11-08 16:56:35,012 - INFO - SHAP calculation finished.
2025-11-08 16:56:35,041 - INFO - SHAP magyarázat elmentve.
2025-11-08 16:56:35,041 - INFO - Benchmarking finished. Saving results...
2025-11-08 16:56:35,043 - INFO - Metrics summary saved to: C:\Users\Gab\BME\szakdolgozat\src\xai_fraud_detection_benchmark\results\benchmark_summary.json
2025-11-08 16:56:35,043 - INFO - Benchmarking finished.
